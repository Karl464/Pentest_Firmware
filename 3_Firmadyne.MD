# Firmadyne

[Firmadyne guide](https://www.youtube.com/watch?v=Zdoef_4LSHA)

# 1. Install and Config

Follow [firmadyne steps](https://github.com/firmadyne/firmadyne)

# 2. Emulate de firmware


Use the extractor to recover only the filesystem. Ensure that the following are set: no kernel (-nk), no parallel operation (-np), populating the image table in the SQL server at 127.0.0.1 (-sql) with the Netgear brand (-b), and storing the tarball in images.

```
sudo python3 sources/extractor/extractor.py -b Netgear -sql 127.0.0.1 -np -nk "WNAP320 Firmware Version 2.0.3.zip" images
```

If it works correctly, you will have a tarball in the image directory.

identify the architecture of firmware 1 and store the result in the image table of the database.

```
sudo bash scripts/getArch.sh images/1.tar.gz.
```

load the contents of the filesystem for firmware 1 into the database and populate the object and object_to_image tables.

```
sudo python3 scripts/tar2db.py -i 1 -f images/1.tar.gz.
```

Create the QEMU disk image for firmware 1.

```
sudo bash scripts/makeImage.sh 1.
```

Now you are ready to set up networking. It should then be available on the network like any other node.

```
sudo bash scripts/inferNetwork.sh 1.
```

Now we are ready to emulate firmware 1 with the inferred network configuration. This will modify the configuration of the host system by creating a Test Access Point (TAP) device and adding a route.

```
sudo bash scratch/1/run.sh.
```

Take some time. Be patient

![3_firmadyne](imgs/3_firmadyne.png)

# 3. Testing


check snmp

```
sudo bash analyses/snmpwalk.sh 192.168.0.100.
```

check website

```
sudo python3 analyses/webAccess.py 1 192.168.0.100 log.txt.
```

Metasploit interface that will look for vulnerabilities

```
sudo mkdir exploits.
sudo chmod +x analyses/runExploits.py.
sudo python analyses/runExploits.py -t 192.168.0.100 -o exploits/exploit -e x
```
